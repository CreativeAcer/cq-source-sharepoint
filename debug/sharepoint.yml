kind: source
spec:
  name: "sharepoint"
  registry: "local"
  path: "../bin/cq-source-sharepoint"
  version: "development"
  destinations: ["${CQ_DESTINATION}"]
  spec:
    auth:
      strategy: "addin"
      creds:
        siteUrl: ${SP_SITE_URL}
        clientId: ${SP_CLIENT_ID}
        clientSecret: ${SP_CLIENT_SECRET}
    lists:
      _catalogs/users:
        select:
          - Title
        alias: "users"
      Shared Documents:
        select:
          - FileLeafRef
          - FileRef
          - FileDirRef
        alias: "documents"
      Lists/Customer:
        select:
          - Title
          - Description
          - Options
          - Attachments
          - Author/Title
        expand:
          - Author
        alias: "customer"
        
